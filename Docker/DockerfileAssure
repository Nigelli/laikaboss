# laikaassure - Validation tool for laikaboss deployments
FROM python:3.10-slim-bookworm

LABEL maintainer="Laikaboss Team"
LABEL description="Laikaassure - validation and smoke testing tool for laikaboss"

# Install dependencies
RUN pip install --no-cache-dir \
    PyYAML \
    Flask \
    requests \
    pyzmq

# Create app directory
WORKDIR /app

# Copy laikaassure package
COPY laikaassure/ /app/laikaassure/

# Copy laikaboss client libraries for ZMQ support
COPY laikaboss/clientLib.py /app/laikaboss/clientLib.py
COPY laikaboss/objectmodel.py /app/laikaboss/objectmodel.py
COPY laikaboss/constants.py /app/laikaboss/constants.py
COPY laikaboss/__init__.py /app/laikaboss/__init__.py

# Set Python path
ENV PYTHONPATH=/app

# Default port
EXPOSE 5080

# Default command runs the web server
ENTRYPOINT ["python", "-m", "laikaassure.assureserver"]
CMD ["--host", "0.0.0.0", "--port", "5080"]
